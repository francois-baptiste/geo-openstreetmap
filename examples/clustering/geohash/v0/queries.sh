bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "00" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "00" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "01" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "01" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "02" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "02" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "03" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "03" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "04" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "04" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "05" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "05" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "06" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "06" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "07" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "07" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "08" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "08" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "09" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "09" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "0z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "0z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "10" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "10" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "11" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "11" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "12" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "12" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "13" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "13" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "14" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "14" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "15" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "15" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "16" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "16" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "17" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "17" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "18" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "18" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "19" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "19" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "1z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "1z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "20" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "20" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "21" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "21" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "22" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "22" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "23" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "23" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "24" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "24" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "25" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "25" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "26" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "26" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "27" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "27" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "28" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "28" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "29" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "29" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "2z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "2z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "30" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "30" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "31" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "31" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "32" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "32" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "33" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "33" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "34" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "34" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "35" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "35" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "36" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "36" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "37" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "37" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "38" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "38" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "39" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "39" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "3z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "3z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "40" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "40" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "41" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "41" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "42" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "42" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "43" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "43" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "44" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "44" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "45" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "45" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "46" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "46" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "47" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "47" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "48" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "48" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "49" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "49" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "4z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "4z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "50" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "50" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "51" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "51" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "52" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "52" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "53" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "53" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "54" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "54" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "55" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "55" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "56" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "56" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "57" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "57" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "58" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "58" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "59" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "59" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "5z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "5z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "60" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "60" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "61" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "61" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "62" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "62" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "63" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "63" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "64" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "64" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "65" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "65" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "66" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "66" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "67" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "67" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "68" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "68" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "69" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "69" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "6z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "6z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "70" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "70" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "71" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "71" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "72" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "72" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "73" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "73" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "74" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "74" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "75" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "75" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "76" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "76" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "77" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "77" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "78" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "78" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "79" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "79" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "7z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "7z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "80" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "80" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "81" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "81" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "82" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "82" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "83" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "83" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "84" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "84" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "85" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "85" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "86" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "86" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "87" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "87" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "88" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "88" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "89" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "89" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "8z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "8z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "90" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "90" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "91" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "91" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "92" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "92" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "93" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "93" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "94" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "94" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "95" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "95" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "96" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "96" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "97" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "97" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "98" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "98" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "99" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "99" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9b" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9b" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9c" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9c" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9d" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9d" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9e" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9e" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9f" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9f" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9g" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9g" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9h" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9h" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9j" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9j" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9k" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9k" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9m" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9m" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9n" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9n" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9p" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9p" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9q" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9q" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9r" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9r" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9s" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9s" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9t" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9t" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9u" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9u" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9v" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9v" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9w" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9w" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9x" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9x" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9y" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9y" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "9z" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "9z" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "b9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "b9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "be" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "be" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "br" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "br" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "by" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "by" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "bz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "bz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "c9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "c9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ce" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ce" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ch" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ch" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ck" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ck" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ct" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ct" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "cz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "cz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "d9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "d9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "db" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "db" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "de" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "de" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "df" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "df" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ds" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ds" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "du" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "du" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "dz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "dz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "e9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "e9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "eb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "eb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ec" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ec" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ed" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ed" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ee" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ee" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ef" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ef" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "eg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "eg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "eh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "eh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ej" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ej" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ek" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ek" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "em" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "em" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "en" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "en" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ep" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ep" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "eq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "eq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "er" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "er" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "es" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "es" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "et" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "et" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "eu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "eu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ev" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ev" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ew" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ew" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ex" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ex" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ey" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ey" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ez" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ez" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "f9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "f9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fe" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fe" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ff" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ff" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ft" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ft" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "fz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "fz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "g9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "g9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ge" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ge" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "gz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "gz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "h9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "h9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "he" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "he" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ht" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ht" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "hz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "hz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "j9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "j9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "je" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "je" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "js" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "js" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ju" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ju" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "jz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "jz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "k9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "k9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ke" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ke" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "km" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "km" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ks" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ks" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ku" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ku" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ky" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ky" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "kz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "kz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "m9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "m9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "md" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "md" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "me" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "me" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ms" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ms" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "my" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "my" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "mz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "mz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "n9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "n9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ne" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ne" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ng" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ng" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "np" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "np" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ns" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ns" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ny" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ny" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "nz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "nz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "p9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "p9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pe" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pe" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ph" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ph" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ps" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ps" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "px" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "px" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "py" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "py" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "pz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "pz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "q9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "q9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qe" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qe" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "qz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "qz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "r9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "r9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "re" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "re" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ru" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ru" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ry" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ry" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "rz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "rz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "s9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "s9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "se" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "se" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ss" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ss" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "st" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "st" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "su" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "su" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "sz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "sz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "t9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "t9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "td" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "td" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "te" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "te" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "th" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "th" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ts" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ts" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ty" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ty" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "tz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "tz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "u9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "u9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ub" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ub" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ud" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ud" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ue" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ue" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ug" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ug" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "um" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "um" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "un" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "un" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "up" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "up" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ur" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ur" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "us" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "us" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ut" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ut" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ux" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ux" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "uz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "uz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "v9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "v9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ve" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ve" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "vz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "vz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "w9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "w9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "we" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "we" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ws" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ws" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ww" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ww" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "wz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "wz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "x9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "x9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xe" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xe" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "xz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "xz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "y9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "y9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ye" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ye" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ym" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ym" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ys" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ys" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "yz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "yz" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z0" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z0" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z1" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z1" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z2" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z2" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z3" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z3" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z4" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z4" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z5" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z5" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z6" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z6" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z7" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z7" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z8" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z8" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "z9" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "z9" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zb" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zb" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zc" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zc" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zd" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zd" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "ze" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "ze" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zf" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zf" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zg" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zg" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zh" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zh" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zj" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zj" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zk" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zk" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zm" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zm" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zn" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zn" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zp" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zp" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zq" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zq" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zr" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zr" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zs" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zs" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zt" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zt" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zu" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zu" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zv" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zv" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zw" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zw" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zx" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zx" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zy" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zy" GROUP BY grid.geohash '
bq query --append_table --destination_table gcp-pdp-osm-dev:geohash.level_7_lbcs_similarities --nosynchronous_mode --nouse_legacy_sql ' WITH lbcs_f_similarities AS (SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Function" AND SUBSTR(grid.geohash, 1, 2) = "zz" GROUP BY grid.geohash) SELECT   grid.geohash,   MAX(udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec)) as max_similarity_a,   ANY_VALUE(lbcs_f.max_similarity) as max_similarity_f FROM   `gcp-pdp-osm-dev.geohash.level_7_vectors_tfidf` tfidf JOIN `gcp-pdp-osm-dev.geohash.level_7` grid USING(geohash) JOIN lbcs_f_similarities lbcs_f USING(geohash) CROSS JOIN `gcp-pdp-osm-dev.lbcs.lbcs_tfidf_layers` lbcs WHERE udfs.cosine_similarity(tfidf.tfidf_vec, lbcs.tfidf_vec) > 0 AND lbcs.dimension = "Activity" AND SUBSTR(grid.geohash, 1, 2) = "zz" GROUP BY grid.geohash '
